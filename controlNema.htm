<html>
   <head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>JavaScript MQTT WebSocket Example</title>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript">
	 </script>
	 <script type = "text/javascript" language = "javascript">
		var mqtt;
		var reconnectTimeout = 2000;
		var smsg="testing"
		var host="broker.emqx.io";
		var port=8083;
		
	 	function send() {
			console.log("send: "+smsg);
			message = new Paho.MQTT.Message(smsg);
			message.destinationName = "insession";
			mqtt.send(message);
			
	  	}

	 	function sendOrder(direction,position,speed) {
			console.log("connecting to "+ host +" "+ port);
				var x=Math.floor(Math.random() * 10000); 
			var cname="orderform-"+x;
			
			mqtt = new Paho.MQTT.Client(host,port,cname);
			smsg=direction;
			posistionstr=String.fromCharCode(Math.floor(position/256), position%256);
			speedstr=String.fromCharCode(Math.floor(speed/256), speed%256);
			smsg=smsg+posistionstr+speedstr;
			var options = {
				timeout: 3,
				onSuccess: send,  
		 	};
			mqtt.connect(options); //connect
		}
	 
	  </script>
   </head>

   <style>
	.center {
	  display: flex;
	  justify-content: center;
	  align-items: center;
	  height: 200px;
	  border: 3px solid green; 
	}
	h1 {text-align: center;}

	</style>
     <body>
   <h1>Control Nema17</h1>
   <div class="center">
	
   <button onclick="sendOrder('-',400,200)">Turn left</button>
   <button onclick="sendOrder('+',400,200)">Turn right</button>
	</div>
   </body>	
</html>